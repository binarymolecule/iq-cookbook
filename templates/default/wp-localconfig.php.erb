<?php

define('WP_SITEURL', '<%= @url %>');
define('WP_HOME', '<%= @url %>');

define('FORCE_SSL_ADMIN', false);
define('FORCE_SSL_LOGIN', false);

define('WP_ALLOW_MULTISITE', false);
define('WP_AUTO_UPDATE_CORE', false);
define('DISALLOW_FILE_MODS', true);
define('DISALLOW_FILE_EDIT', true);

define('WP_CACHE', true);

define('DB_NAME', '<%= @db %>');
define('DB_USER', '<%= @user %>');
define('DB_PASSWORD', '<%= @password %>');
define('DB_HOST', '<%= @host %>');
define('DB_CHARSET', 'utf8');
define('DB_COLLATE', '');

$storage_url = '<%= @storage %>';

if ($storage_url !== false) {

  $storage = parse_url($storage_url);
  $storage_location = split('\.', $storage["host"], 2);
  $bucket = $storage_location[0];
  $endpoint = $storage_location[1];

  // Enables the plugin and use configuration from contants.
  define('WPRO_ON', true);

  // Amazon S3 is the service. (s3)
  define('WPRO_SERVICE', $storage["scheme"]);

  // Prepend all URI paths at S3 with this folder. In most cases, you probably want this to be empty.
  define('WPRO_FOLDER', $storage["path"]);
  define('WPRO_AWS_KEY', urldecode($storage["user"]));
  define('WPRO_AWS_SECRET', urldecode($storage["pass"]));

  // The name of the Amazon S3 bucket where your files should be stored.
  define('WPRO_AWS_BUCKET', $bucket);

  // If you have a virthost for your Amazon S3 bucket, it should be there.
  // define('WPRO_AWS_VIRTHOST', 'files.example.org'); 

  // The Amazon endpoint datacenter where your S3 bucket is.
  define('WPRO_AWS_ENDPOINT', $endpoint);
  
  define('WPRO_PROXY', true);
} else {
  // define('UPLOADS', '')
  
  print "DATABASE_URL not set.\n";
  die();
}
